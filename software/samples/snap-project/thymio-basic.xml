<blocks app="Snap! 4.0, http://snap.berkeley.edu" version="1"><block-definition s="$turtle get nodes" type="reporter" category="sensing"><header></header><code></code><inputs></inputs><script><block s="doDeclareVariables"><list><l>request</l></list></block><block s="doSetVar"><l>request</l><block s="reportURL"><custom-block s="$turtle thymio URL of node %txt"><l></l></custom-block></block></block><block s="doReport"><custom-block s="remove duplicates from %l"><custom-block s="append %mult%l"><list><custom-block s="map %repRing over %mult%l"><block s="reifyReporter"><autolambda><custom-block s="Query %s from %l"><l>name</l><l/></custom-block></autolambda><list></list></block><list><custom-block s="listify %s"><block var="request"/></custom-block></list></custom-block><custom-block s="map %repRing over %mult%l"><block s="reifyReporter"><autolambda><custom-block s="Query %s from %l"><l>node</l><l/></custom-block></autolambda><list></list></block><list><custom-block s="listify %s"><block var="request"/></custom-block></list></custom-block></list></custom-block></custom-block></block></script></block-definition><block-definition s="$turtle thymio URL of node %&apos;node&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%txt"></input></inputs><script><block s="doDeclareVariables"><list><l>output</l></list></block><block s="doSetVar"><l>output</l><block s="reportJoinWords"><list><block var="thymio hostname"/><l>:</l><block var="thymio port"/><l>/nodes/</l><block var="node"/></list></block></block><block s="doIf"><block s="reportNot"><block s="reportEquals"><block s="reportListItem"><l><option>last</option></l><block s="reportTextSplit"><block var="output"/><l><option>letter</option></l></block></block><l>/</l></block></block><script><block s="doSetVar"><l>output</l><block s="reportJoinWords"><list><block var="output"/><l>/</l></list></block></block></script></block><block s="doReport"><block var="output"/></block></script></block-definition><block-definition s="$turtle init Thymio host %&apos;host&apos; port %&apos;port&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%txt">localhost</input><input type="%n">3000</input></inputs><script><block s="doSetVar"><l>thymio hostname</l><block var="host"/></block><block s="doSetVar"><l>thymio port</l><block var="port"/></block><block s="doSetVar"><l>thymio node</l><block s="reportListItem"><l>2</l><custom-block s="$turtle get nodes"></custom-block></block></block></script></block-definition><block-definition s="$turtle get all variables name of node %&apos;node&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%txt">thymio-II</input></inputs><script><custom-block s="for each %upvar of %l %cs"><l>item</l><custom-block s="listify %s"><block s="reportURL"><custom-block s="$turtle thymio URL of node %txt"><block var="node"/></custom-block></block></custom-block><script><block s="doIf"><block s="reportEquals"><block s="reportListItem"><l>1</l><block var="item"/></block><l>namedVariables</l></block><script><block s="doReport"><custom-block s="map %repRing over %mult%l"><block s="reifyReporter"><autolambda><block s="reportListItem"><l>1</l><l/></block></autolambda><list></list></block><list><block s="reportListItem"><l>2</l><block var="item"/></block></list></custom-block></block></script></block></script></custom-block><block s="doReport"><l></l></block></script></block-definition><block-definition s="$turtle set %&apos;direction&apos; motor speed %&apos;speed&apos;" type="command" category="sensing"><header></header><code></code><inputs><input type="%txt">left<options>left
right</options></input><input type="%s"></input></inputs><script><block s="doIfElse"><block s="reportEquals"><block var="direction"/><l>left</l></block><script><custom-block s="$turtle set register %s of thymio %txt value %s"><l>motor.left.target</l><block var="thymio node"/><block var="speed"/></custom-block></script><script><custom-block s="$turtle set register %s of thymio %txt value %s"><l>motor.right.target</l><block var="thymio node"/><block var="speed"/></custom-block></script></block></script></block-definition><block-definition s="$turtle get register %&apos;register&apos; of thymio %&apos;thymio&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%s"></input><input type="%txt">thymio-II</input></inputs><script><block s="doReport"><custom-block s="listify %s"><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="$turtle thymio URL of node %txt"><block var="thymio"/></custom-block><block var="register"/></list></block></block></custom-block></block></script></block-definition><block-definition s="$turtle set register %&apos;register&apos; of thymio %&apos;thymio&apos; value %&apos;values&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%s"></input><input type="%txt">thymio-II</input><input type="%s"></input></inputs><script><block s="doDeclareVariables"><list><l>values str</l></list></block><block s="doSetVar"><l>values str</l><l></l></block><block s="doIfElse"><block s="reportIsA"><block var="values"/><l><option>list</option></l></block><script><custom-block s="for each %upvar of %l %cs"><l>v</l><block var="values"/><script><block s="doSetVar"><l>values str</l><block s="reportJoinWords"><list><block var="values str"/><l>/</l><block var="v"/></list></block></block></script></custom-block></script><script><block s="doSetVar"><l>values str</l><block var="values"/></block></script></block><block s="fork"><block s="reifyReporter"><autolambda><block s="reportURL"><block s="reportJoinWords"><list><custom-block s="$turtle thymio URL of node %txt"><block var="thymio"/></custom-block><block var="register"/><l>/</l><block var="values str"/></list></block></block></autolambda><list></list></block><list></list></block></script></block-definition><block-definition s="$turtle distance %&apos;dir&apos;" type="reporter" category="sensing"><header></header><code></code><inputs><input type="%s">ground<options>ground
front
back</options></input></inputs><script><block s="doIf"><block s="reportEquals"><block var="dir"/><l>ground</l></block><script><block s="doReport"><custom-block s="$turtle get register %s of thymio %txt"><l>prox.ground.reflected</l><block var="thymio node"/></custom-block></block></script></block><block s="doIf"><block s="reportEquals"><block var="dir"/><l>front</l></block><script><block s="doReport"><custom-block s="items %n to %n of %l"><l>1</l><l>5</l><custom-block s="$turtle get register %s of thymio %txt"><l>prox.horizontal</l><block var="thymio node"/></custom-block></custom-block></block></script></block><block s="doIf"><block s="reportEquals"><block var="dir"/><l>back</l></block><script><block s="doReport"><custom-block s="items %n to %n of %l"><l>6</l><l>7</l><custom-block s="$turtle get register %s of thymio %txt"><l>prox.horizontal</l><block var="thymio node"/></custom-block></custom-block></block></script></block></script></block-definition><block-definition s="$turtle move %&apos;distance&apos; mm" type="command" category="sensing"><header></header><code></code><inputs><input type="%s">50</input></inputs><script><block s="doDeclareVariables"><list><l>speed</l></list></block><block s="doSetVar"><l>speed</l><custom-block s="if %b then %anyUE else %anyUE"><block s="reportGreaterThan"><block var="distance"/><l>0</l></block><l>100</l><l>-100</l></custom-block></block><custom-block s="$turtle set %txt motor speed %s"><l>left</l><block var="speed"/></custom-block><custom-block s="$turtle set %txt motor speed %s"><l>right</l><block var="speed"/></custom-block><block s="doWait"><block s="reportProduct"><block s="reportMonadic"><l><option>abs</option></l><block var="distance"/></block><l>0.02</l></block></block><custom-block s="$turtle set %txt motor speed %s"><l>left</l><l>0</l></custom-block><custom-block s="$turtle set %txt motor speed %s"><l>right</l><l>0</l></custom-block></script><scripts><script x="70.218752" y="275.000004"><custom-block s="$turtle set %txt motor speed %s"><l>right</l><l>0</l></custom-block></script></scripts></block-definition><block-definition s="$turtle stop motors" type="command" category="sensing"><header></header><code></code><inputs></inputs><script><custom-block s="$turtle set %txt motor speed %s"><l>left</l><l>0</l></custom-block><custom-block s="$turtle set %txt motor speed %s"><l>right</l><l>0</l></custom-block></script></block-definition><block-definition s="$turtle leds set color red %&apos;r&apos; green %&apos;g&apos; blue %&apos;b&apos;" type="command" category="sensing"><header></header><code></code><inputs><input type="%s"></input><input type="%s"></input><input type="%s"></input></inputs><script><custom-block s="$turtle set register %s of thymio %txt value %s"><l>V_leds_top</l><block var="thymio node"/><block s="reportNewList"><list><block var="r"/><block var="g"/><block var="b"/></list></block></custom-block></script></block-definition><block-definition s="$turtle %&apos;state&apos; follow line" type="command" category="sensing"><header></header><code></code><inputs><input type="%txt">start<options>start
stop</options></input></inputs><script><custom-block s="$turtle set register %s of thymio %txt value %s"><l>follow_line_state</l><block var="thymio node"/><custom-block s="if %b then %anyUE else %anyUE"><block s="reportEquals"><block var="state"/><l>start</l></block><l>1</l><l>0</l></custom-block></custom-block><custom-block s="$turtle set register %s of thymio %txt value %s"><l>follow_line_state_changed</l><block var="thymio node"/><l>1</l></custom-block></script><scripts><script x="31" y="172.2"><custom-block s="$turtle set register %s of thymio %txt value %s"><l>follow_line_state_changed</l><block var="thymio node"/><l>1</l></custom-block></script></scripts></block-definition></blocks>